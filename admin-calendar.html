<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
<title>è¡Œäº‹æ›†ç®¡ç† - å¯è‰å…’ Hair Salon</title>
<style>
:root{
  --bg:#f7fff7;
  --card:#ffffff;
  --accent:#a8e6cf;
  --btn:#ccc;
  --today-bg: #fffbf0;
}
body{font-family:Arial, Helvetica, sans-serif;background:var(--bg);margin:0;padding:0;color:#333; padding-bottom: 20px;}

/* =========================================
   1. å°èˆªåˆ— (ç¶­æŒæ‚¨å–œæ­¡çš„åŸæœ¬æ¨£å¼)
   ========================================= */
header{background:#a8e6cf;padding:10px;display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;}
header h1{margin:0;color:#4a7c53;font-weight:bold;font-size:18px;}

nav {
  overflow-x: auto;
  overflow-y: hidden;
  -webkit-overflow-scrolling: touch;
  width: 100%; /* æ‰‹æ©Ÿä¸Šè®“å®ƒä½”æ»¿å¯¬åº¦ */
  margin-top: 10px; /* æ‰‹æ©Ÿä¸Šèˆ‡æ¨™é¡Œåˆ†é–‹ä¸€é» */
}
/* é›»è…¦ç‰ˆ header èª¿æ•´ */
@media (min-width: 768px) {
  nav { width: auto; margin-top: 0; }
}

nav ul{
  list-style:none; display:flex; gap:12px; margin:0; padding:0 5px; white-space:nowrap;
}
nav a{
  text-decoration:none; color:#333; font-weight:bold; padding:6px 12px; border-radius:4px; flex-shrink: 0;
}
nav a:hover, nav a.active{background:#7bd8a2;color:#fff;}

/* =========================================
   2. è¡Œäº‹æ›† (æ™ºæ…§éŸ¿æ‡‰å¼è¨­è¨ˆ)
   ========================================= */
#controls { text-align:center; margin:15px 0; display: flex; justify-content: center; align-items: center; gap: 8px;}
#monthLabel { font-weight:bold; font-size: 1.1rem; min-width: 100px; display: inline-block;}

/* æŒ‰éˆ•æ¨£å¼å„ªåŒ– */
button.ctrl-btn { 
  margin:0; padding:6px 12px; background:#7bd8a2; border:none; color:#fff; border-radius:4px; cursor:pointer; 
}
button.ctrl-btn:hover { background:#5bb174; }

#calendar { 
  display:grid; 
  grid-template-columns:repeat(7,1fr); 
  gap:2px; 
  max-width:800px; 
  margin:0 auto; 
  padding: 0 4px; /* æ‰‹æ©Ÿç‰ˆé‚Šè·ç•™ç™½ */
}

/* æ˜ŸæœŸæ¨™é¡Œ */
.week-cell { 
  text-align:center; padding:8px 0; background:#e0f2e9; font-weight:bold; 
  font-size: 0.9rem; border-radius: 4px; color: #4a7c53;
}

/* æ—¥æœŸæ ¼å­ - é€šç”¨è¨­å®š */
.calendar-cell { 
  background:#fff; 
  cursor:pointer; 
  position:relative; 
  border:1px solid #ddd; 
  border-radius: 5px;
  display: flex; 
  flex-direction: column; 
  align-items: center;
  transition: background 0.1s;
}
.calendar-cell.is-today { background: var(--today-bg); border: 2px solid #ffc107; }
.calendar-cell:active { background: #eee; } /* é»æ“Šå›é¥‹ */

.date-num { font-weight: bold; margin-top: 4px; }
.label-container { 
  width: 100%; display: flex; flex-direction: column; 
  align-items: center; gap: 2px; margin-top: 2px; 
}

/* --- [é—œéµ] é›»è…¦ç‰ˆæ¨£å¼ (å¯¬åº¦ > 600px) --- */
@media (min-width: 601px) {
  .calendar-cell { min-height: 85px; }
  .label { 
    font-size: 0.75rem; color:#fff; padding: 2px 6px; border-radius: 10px;
    width: 85%; text-align: center; white-space: nowrap; overflow: hidden;
  }
}

/* --- [é—œéµ] æ‰‹æ©Ÿç‰ˆæ¨£å¼ (å¯¬åº¦ <= 600px) --- */
@media (max-width: 600px) {
  /* 1. æ¸›å°‘é«˜åº¦ï¼Œè®“ç•«é¢èƒ½å¡ä¸‹æ›´å¤šé€± */
  .calendar-cell { min-height: 60px; padding-bottom: 2px; }
  
  /* 2. æ—¥æœŸæ•¸å­—ç¸®å°ä¸€é» */
  .date-num { font-size: 0.9rem; margin-top: 3px; }

  /* 3. æ¨™ç±¤æ”¹ç‚ºã€Œåœ“é»å¾½ç« ã€æ¨¡å¼ï¼šä¸é¡¯ç¤ºæ–‡å­—ï¼Œåªé¡¯ç¤ºæ•¸å­—åœ“åœˆ */
  .label-container { 
    flex-direction: row; /* è®“ç´…ç¶ ç‡ˆä¸¦æ’é¡¯ç¤ºï¼Œç¯€çœå‚ç›´ç©ºé–“ */
    justify-content: center; 
    gap: 3px;
    flex-wrap: wrap; /* å¦‚æœå¤ªå¤šå°±æ›è¡Œ */
  }
  .label {
    width: 20px; height: 20px; /* å›ºå®šåœ“å½¢å¤§å° */
    font-size: 11px; font-weight: bold; color: #fff;
    border-radius: 50%; /* è®Šæˆåœ“å½¢ */
    display: flex; justify-content: center; align-items: center; /* æ•¸å­—ç½®ä¸­ */
    padding: 0;
  }
  /* éš±è— "é ç´„" "å®Œæˆ" æ–‡å­—ï¼Œé€™éœ€è¦ JS é…åˆï¼Œæˆ–è€…ç”¨ CSS æˆªæ–· */
  /* é€™è£¡æˆ‘å€‘æœƒåœ¨ JS è£¡åšåˆ¤æ–·ï¼Œå¦‚æœå¯¬åº¦å°å°±åªå¡æ•¸å­— */
}

/* =========================================
   3. Modal (ç¶­æŒä¸­é–“å½ˆçª—)
   ========================================= */
#modalOverlay { display:none; position:fixed; top:0; left:0; right:0; bottom:0; background:rgba(0,0,0,0.5); z-index:99; }
#appointmentModal {
  display:none; position:fixed; top:50%; left:50%; transform:translate(-50%,-50%);
  background:#fff; width: 90%; max-width:400px; 
  max-height: 85vh; overflow-y: auto;
  border-radius:8px; padding:20px; z-index:100; box-shadow: 0 4px 15px rgba(0,0,0,0.3);
}

.modal-header { display:flex; justify-content:space-between; align-items:center; border-bottom:1px solid #ddd; padding-bottom:10px; margin-bottom:10px; }
.close-btn { background:none; border:none; font-size:1.8rem; color:#666; cursor:pointer; line-height: 1;}

.apptRow { 
  background: #fcfcfc; border: 1px solid #eee; border-radius: 6px;
  padding:10px; margin-bottom: 8px; 
}
.apptInfo { font-size: 1rem; margin-bottom: 5px; }
.apptBtnGroup { display:flex; gap:8px; margin-top:8px; }
.apptBtnGroup button { 
  flex: 1; padding:8px 0; border:none; border-radius:4px; font-weight:bold; cursor:pointer; font-size: 0.9rem;
}
.btn-done { background:#5cb85c; color:#fff; }
.btn-cancel { background:#ff5c5c; color:#fff; }
.btn-del { background:#eee; color:#333; }

#newApptForm { margin-top: 15px; padding-top:15px; border-top:1px solid #eee; display: flex; flex-direction: column; gap: 10px;}
#newApptForm input, #newApptForm select { padding:10px; border:1px solid #ccc; border-radius:4px; font-size:16px; width: 100%; box-sizing: border-box;}
#addApptBtn { padding:12px; background:#3399ff; color:#fff; border:none; border-radius:6px; font-weight:bold; font-size:16px; cursor:pointer; width: 100%; }

</style>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
</head>
<body>

<header>
  <h1>å¯è‰å…’ Hair Salon - ç®¡ç†å¾Œå°</h1>
  <nav>
    <ul>
      <li><a href="admin-calendar.html" class="active">è¡Œäº‹æ›†ç®¡ç†</a></li>
      <li><a href="vip_test.html">VIPç®¡ç†</a></li>
      <li><a href="admin-news.html">å…¬å‘Šç®¡ç†</a></li>
      <li><a href="message.html">ç•™è¨€ç®¡ç†</a></li>
    </ul>
  </nav>
</header>

<div id="controls">
  <button id="prevMonth" class="ctrl-btn">&lt;</button>
  <span id="monthLabel"></span>
  <button id="nextMonth" class="ctrl-btn">&gt;</button>
  <button id="refreshBtn" class="ctrl-btn" style="background:#3399ff;">â†»</button>
</div>

<div id="calendar"></div>

<div id="modalOverlay"></div>
<div id="appointmentModal">
  <div class="modal-header">
    <h3 id="modalDate" style="margin:0"></h3>
    <button class="close-btn" onclick="closeModal()">Ã—</button>
  </div>
  <div id="modalContent"></div>
  
  <div id="newApptForm">
    <h4 style="margin:0;">å¿«é€Ÿé ç´„</h4>
    <input type="text" id="newName" placeholder="å§“å">
    <input type="tel" id="newPhone" placeholder="é›»è©±">
    <div style="display:flex; gap:10px;">
      <select id="newTime"></select>
      <select id="newService">
        <option value="å‰ªé«®">å‰ªé«®</option>
        <option value="æ´—é«®">æ´—é«®</option>
        <option value="ç‡™é«®">ç‡™é«®</option>
        <option value="æŸ“é«®">æŸ“é«®</option>
        <option value="è­·é«®">è­·é«®</option>
      </select>
    </div>
    <button id="addApptBtn">ç¢ºèªæ–°å¢</button>
  </div>
</div>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyCfxDOOzTLbmQRfvW275hJrtOnX_t-6-yc",
  authDomain: "hsinformation.firebaseapp.com",
  projectId: "hsinformation"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();

let appointments = {};
let today = new Date();
let currentYear = today.getFullYear();
let currentMonth = today.getMonth();
let selectedDay = '';
const weekDays = ['æ—¥','ä¸€','äºŒ','ä¸‰','å››','äº”','å…­'];

const LINE_API_URL = "https://script.google.com/macros/library/d/1YAlK-NQd7zcY4IWlIOVQ514jK3UsIuMnG2FVqfUpCxLJ4u2CnsW7pXBf/2";

checkAuthAndLoad();

function checkAuthAndLoad() {
    if(!localStorage.getItem('calendar_authenticated')){
        const password = prompt('è«‹è¼¸å…¥ç®¡ç†å¯†ç¢¼');
        if(password === 'clear0921'){
            localStorage.setItem('calendar_authenticated','true');
            loadAppointments(currentYear, currentMonth);
        } else {
            alert('å¯†ç¢¼éŒ¯èª¤ï¼');
            document.body.innerHTML='<h2 style="text-align:center;margin-top:100px;">å¯†ç¢¼éŒ¯èª¤</h2>';
        }
    } else {
        loadAppointments(currentYear, currentMonth);
    }
}

async function loadAppointments(year, month){
  document.getElementById('monthLabel').textContent = "è®€å–ä¸­...";
  const start = `${year}-${String(month+1).padStart(2,'0')}-01`;
  const end = `${year}-${String(month+1).padStart(2,'0')}-31`;
  
  try {
    const snapshot = await db.collection('appointments')
        .where('date', '>=', start).where('date', '<=', end).get();
    appointments = {};
    snapshot.forEach(doc=>{
        const data = doc.data();
        if(!appointments[data.date]) appointments[data.date]=[];
        appointments[data.date].push({...data, id: doc.id});
    });
    buildCalendar(year, month);
  } catch (error) {
    alert("è®€å–å¤±æ•—");
  }
}

function buildCalendar(year, month){
  const calendar = document.getElementById('calendar');
  calendar.innerHTML='';
  document.getElementById('monthLabel').textContent=`${year} å¹´ ${month+1} æœˆ`;

  weekDays.forEach(d=>{
    const cell=document.createElement('div');
    cell.classList.add('week-cell');
    cell.textContent=d;
    calendar.appendChild(cell);
  });

  const firstDay = new Date(year, month, 1);
  const lastDay = new Date(year, month + 1, 0);
  const startWeek = firstDay.getDay(); 
  const totalDays = lastDay.getDate();
  const todayStr = `${new Date().getFullYear()}-${String(new Date().getMonth()+1).padStart(2,'0')}-${String(new Date().getDate()).padStart(2,'0')}`;

  // ç©ºç™½æ ¼
  for(let i=0; i<startWeek; i++){
    const cell=document.createElement('div');
    cell.classList.add('calendar-cell');
    cell.style.background='#fcfcfc';
    cell.style.border='none';
    calendar.appendChild(cell);
  }

  // æ—¥æœŸæ ¼
  for(let d=1; d<=totalDays; d++){
    const dayStr=`${year}-${String(month+1).padStart(2,'0')}-${String(d).padStart(2,'0')}`;
    const cell=document.createElement('div');
    cell.classList.add('calendar-cell');
    if(dayStr === todayStr) cell.classList.add('is-today');

    const dateNum = document.createElement('div');
    dateNum.classList.add('date-num');
    dateNum.textContent = d;
    cell.appendChild(dateNum);

    const dayAppts = appointments[dayStr] || [];
    const labelContainer = document.createElement('div');
    labelContainer.classList.add('label-container');

    if(dayAppts.length > 0){
      const completedCount = dayAppts.filter(a=>a.status==='å·²å®Œæˆ').length;
      const pendingCount = dayAppts.filter(a=>a.status==='å·²é ç´„').length;

      // åˆ¤æ–·æ˜¯å¦ç‚ºå°è¢å¹• (é€é CSS media query ç”Ÿæ•ˆï¼Œä½†å…§å®¹æˆ‘å€‘çµ±ä¸€è¼¸å‡º)
      // é€™è£¡åˆ©ç”¨ CSS æ§åˆ¶ï¼šæ‰‹æ©Ÿç‰ˆæ™‚é¡¯ç¤ºæˆåœ“åœˆï¼Œé›»è…¦ç‰ˆæ™‚é¡¯ç¤ºæˆé•·æ¢
      
      if(pendingCount>0){
        const label = document.createElement('div');
        label.classList.add('label');
        label.style.background='#ff5c5c';
        // æ‰‹æ©Ÿèˆ‡é›»è…¦å…±ç”¨é€™å€‹ DOMï¼Œä½†ç”¨ CSS éš±è—æ–‡å­— overflow
        // æˆ‘å€‘åœ¨è£¡é¢æ”¾æ•¸å­—ï¼Œé›»è…¦ç‰ˆæœƒçœ‹èµ·ä¾†åƒ "3"ï¼Œéœ€è¦ç¨å¾® trick ä¸€ä¸‹
        // ç‚ºäº†ç°¡å–®ï¼Œæˆ‘å€‘çµ±ä¸€è¼¸å‡ºæ•¸å­—ï¼Œé›»è…¦ç‰ˆå¯ä»¥é€é ::after åŠ æ–‡å­—ï¼Œæˆ–ç›´æ¥é¡¯ç¤ºæ•¸å­—ä¹Ÿå¯ä»¥
        // ç‚ºäº†ç¬¦åˆæ‚¨çš„éœ€æ±‚ã€Œä¸æ“ ã€ï¼Œæˆ‘å€‘çµ±ä¸€é¡¯ç¤ºæ•¸å­—å³å¯ï¼Œä¹¾æ·¨ä¿è½
        label.textContent = pendingCount; 
        
        // å¦‚æœæ˜¯é›»è…¦ç‰ˆï¼Œæƒ³é¡¯ç¤º "3 é ç´„"ï¼Œå¯ä»¥ç”¨ title å±¬æ€§ hover é¡¯ç¤ºï¼Œæˆ–è€…ç”¨ JS åˆ¤æ–·
        if(window.innerWidth > 600) {
            label.textContent = `${pendingCount} é ç´„`;
        } else {
            label.textContent = pendingCount;
        }

        labelContainer.appendChild(label);
      }
      if(completedCount>0){
        const label = document.createElement('div');
        label.classList.add('label');
        label.style.background='#5cb85c';
        
        if(window.innerWidth > 600) {
            label.textContent = `${completedCount} å®Œæˆ`;
        } else {
            label.textContent = completedCount;
        }
        
        labelContainer.appendChild(label);
      }
    }
    cell.appendChild(labelContainer);
    cell.addEventListener('click', ()=>manageDay(dayStr));
    calendar.appendChild(cell);
  }
}

function manageDay(dayStr){
  selectedDay = dayStr;
  let dayAppointments = appointments[dayStr] || [];
  dayAppointments.sort((a, b) => a.time.localeCompare(b.time));

  const modal = document.getElementById('appointmentModal');
  const overlay = document.getElementById('modalOverlay');
  const content = document.getElementById('modalContent');
  document.getElementById('modalDate').textContent = `ğŸ“… ${dayStr}`;
  content.innerHTML='';

  if(dayAppointments.length === 0) content.innerHTML = '<div style="text-align:center;padding:15px;color:#999">ç„¡é ç´„</div>';

  dayAppointments.forEach((a,i)=>{
    const row = document.createElement('div');
    row.classList.add('apptRow');
    
    // â†“â†“â†“â†“â†“â†“ æ›¿æ›é–‹å§‹ â†“â†“â†“â†“â†“â†“
    row.innerHTML = `
      <div class="apptInfo">
        <b>${a.time}</b> 
        
        <span style="font-size:1.05rem; font-weight:bold; margin-left: 5px;">
          ${a.memberName}
        </span>
        
        <span style="color:#666; font-size:0.95rem; margin-left: 8px;">
          ${a.memberId}
        </span>
        
        <span style="color:#666; font-size:0.9rem; margin-left: 5px;">
          (${a.service})
        </span>

        <div style="font-size:0.85rem; color:#888; margin-top:4px;">
          ç‹€æ…‹: ${a.status}
        </div>
      </div>
    `;
    // â†‘â†‘â†‘â†‘â†‘â†‘ æ›¿æ›çµæŸ â†‘â†‘â†‘â†‘â†‘â†‘

    const btnGroup = document.createElement('div');
    btnGroup.classList.add('apptBtnGroup');

    if(a.status !== 'å·²å®Œæˆ' && a.status !== 'å·²å–æ¶ˆ') {
        const btnDone = document.createElement('button');
        btnDone.textContent='å®Œæˆ';
        btnDone.className = 'btn-done';
        btnDone.onclick = ()=>updateAppointmentStatus(a.id,'å·²å®Œæˆ');
        btnGroup.appendChild(btnDone);

        const btnCancel = document.createElement('button');
        btnCancel.textContent='å–æ¶ˆ';
        btnCancel.className = 'btn-cancel';
        btnCancel.onclick = ()=>updateAppointmentStatus(a.id,'å·²å–æ¶ˆ');
        btnGroup.appendChild(btnCancel);
    }
    const btnDelete = document.createElement('button');
    btnDelete.textContent='åˆªé™¤';
    btnDelete.className = 'btn-del';
    btnDelete.onclick = ()=>deleteAppointment(dayStr, i);
    btnGroup.appendChild(btnDelete);

    row.appendChild(btnGroup);
    content.appendChild(row);
  });

  populateTimeSelect();
  document.getElementById('newName').value='';
  document.getElementById('newPhone').value='';
  
  overlay.style.display='block';
  modal.style.display='block';
}

function closeModal(){
  document.getElementById('appointmentModal').style.display='none';
  document.getElementById('modalOverlay').style.display='none';
}

async function updateAppointmentStatus(apptId, newStatus){
  await db.collection('appointments').doc(apptId).update({ status: newStatus });
  closeModal();
  loadAppointments(currentYear,currentMonth);
}

async function deleteAppointment(dayStr, index){
  if(!confirm("ç¢ºå®šåˆªé™¤ï¼Ÿ")) return;
  const appt = appointments[dayStr][index];
  await db.collection('appointments').doc(appt.id).delete();
  closeModal();
  loadAppointments(currentYear,currentMonth);
}

// â˜…â˜…â˜… ã€ä¿®æ”¹ 2ã€‘æ•´æ®µè¤‡è£½ä¸¦è¦†è“‹åŸæœ¬çš„ addApptBtn ç›£è½å™¨ â˜…â˜…â˜…

document.getElementById('addApptBtn').addEventListener('click', async ()=>{
  // 1. å–å¾—è¼¸å…¥è³‡æ–™
  const name = document.getElementById('newName').value.trim();
  const phone = document.getElementById('newPhone').value.trim();
  const time = document.getElementById('newTime').value;
  const service = document.getElementById('newService').value;
  
  // 2. æª¢æŸ¥å¿…å¡«
  if(!name || !phone){ alert('è«‹å¡«å¯«å®Œæ•´'); return; }
  
  // 3. é–å®šæŒ‰éˆ•é¿å…é‡è¤‡æŒ‰
  const btn = document.getElementById('addApptBtn');
  btn.disabled = true; 
  btn.textContent = "è™•ç†ä¸­...";

  try {
      // 4. å­˜å…¥ Firebase (ç¶­æŒåŸæœ¬åŠŸèƒ½)
      await db.collection('appointments').add({
        memberId: phone, 
        memberName: name, 
        service: service, 
        date: selectedDay, 
        time: time,
        status: 'å·²é ç´„', 
        createdAt: new Date()
      });

      // 5. ç™¼é€ LINE é€šçŸ¥ (é€™æ˜¯æ–°å¢çš„åŠŸèƒ½ï¼)
      // çµ„åˆè¨Šæ¯å…§å®¹
      const msg = `ã€æ–°é ç´„é€šçŸ¥ã€‘\nğŸ“… æ—¥æœŸ: ${selectedDay}\nâ° æ™‚é–“: ${time}\nğŸ‘¤ å®¢æˆ¶: ${name}\nğŸ“ é›»è©±: ${phone}\nğŸ’‡ é …ç›®: ${service}`;
      
      // ç™¼é€çµ¦ Google Apps Script
      // mode: 'no-cors' å¾ˆé‡è¦ï¼Œå®ƒå…è¨±ç€è¦½å™¨ç™¼é€è«‹æ±‚è€Œä¸å ±éŒ¯
      fetch(LINE_API_URL, {
        method: 'POST',
        mode: 'no-cors', 
        body: JSON.stringify({ message: msg }),
        headers: { 'Content-Type': 'application/json' }
      }).catch(err => console.error('LINE ç™¼é€å¤±æ•—', err));

      // 6. æˆåŠŸå¾Œçš„ UI æ›´æ–°
      closeModal();
      loadAppointments(currentYear, currentMonth);
      alert('é ç´„æˆåŠŸï¼LINE é€šçŸ¥å·²ç™¼é€');

  } catch(e) { 
      console.error(e);
      alert("éŒ¯èª¤: " + e.message); 
  } finally { 
      // è§£é–æŒ‰éˆ•
      btn.disabled = false; 
      btn.textContent = "ç¢ºèªæ–°å¢"; 
  }
});

function populateTimeSelect(){
  const select = document.getElementById('newTime');
  select.innerHTML='';
  for(let h=10; h<=20; h++){
    const t = String(h).padStart(2,'0');
    select.appendChild(new Option(`${t}:00`, `${t}:00`));
    if(h!==20) select.appendChild(new Option(`${t}:30`, `${t}:30`));
  }
}

document.getElementById('modalOverlay').addEventListener('click', closeModal);
document.getElementById('prevMonth').addEventListener('click', ()=>{
  currentMonth--; if(currentMonth<0){ currentMonth=11; currentYear--; }
  loadAppointments(currentYear,currentMonth);
});
document.getElementById('nextMonth').addEventListener('click', ()=>{
  currentMonth++; if(currentMonth>11){ currentMonth=0; currentYear++; }
  loadAppointments(currentYear,currentMonth);
});
document.getElementById('refreshBtn').addEventListener('click', ()=>{
  loadAppointments(currentYear,currentMonth);
});

// ç›£è½è¦–çª—å¤§å°æ”¹è®Šï¼Œå³æ™‚æ›´æ–°æ—¥æ›†æ¨™ç±¤æ¨£å¼ (RWD Refresh)
window.addEventListener('resize', ()=>{
    // ç°¡å–®çš„é˜²æŠ–å‹•è™•ç†ï¼Œé¿å…ä¸€ç›´åˆ·æ–°
    clearTimeout(window.resizeTimer);
    window.resizeTimer = setTimeout(()=>{
        buildCalendar(currentYear, currentMonth);
    }, 200);
});
</script>
</body>
</html>
